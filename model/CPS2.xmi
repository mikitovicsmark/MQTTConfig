<?xml version="1.0" encoding="UTF-8"?>
<allocation:CPS
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:allocation="allocation"
    xsi:schemaLocation="allocation Allocation.ecore"
    broker="tcp://localhost:1883">
  <hardwares
      name="LightHardware">
    <instances
        yakindu="//@yakindusm.1"
        clientId="LightClient">
      <subscriber
          inevent="//@yakindusm.1/@inEvents.0 //@yakindusm.1/@inEvents.1"/>
    </instances>
  </hardwares>
  <hardwares
      name="SwitchHardware">
    <instances
        yakindu="//@yakindusm.0"
        clientId="SwitchClient">
      <publisher
          outevent="//@yakindusm.0/@outEvents.0 //@yakindusm.0/@outEvents.1"/>
    </instances>
  </hardwares>
  <hardwares
      name="LightSensorHardware">
    <instances
        yakindu="//@yakindusm.2"
        clientId="LightSensorClient">
      <publisher
          outevent="//@yakindusm.2/@outEvents.0 //@yakindusm.2/@outEvents.1"/>
    </instances>
  </hardwares>
  <hardwares
      name="MovementDetectorHardware">
    <instances
        yakindu="//@yakindusm.3"
        clientId="MovementDetectorClient">
      <publisher
          outevent="//@yakindusm.3/@outEvents.0 //@yakindusm.3/@outEvents.1"/>
    </instances>
  </hardwares>
  <hardwares
      name="ControlPanelHardware">
    <instances
        clientId="ControlPanelClient"/>
  </hardwares>
  <topic name="LightSwitch">
    <messages
        content="TurnOn!"/>
    <messages
        content="TurnOff!"/>
  </topic>
  <topic name="Light">
    <messages
        content="dark"/>
    <messages
        content="bright"/>
  </topic>
  <topic name="Movement">
    <messages
        content="detect"/>
    <messages
        content="stop"/>
  </topic>
  <topic name="ControlPanel">
    <messages
        content="switchSprinklerOff"/>
    <messages
        content="switchSprinklerOn"/>
    <messages
        content="switchLightOff"/>
    <messages
        content="switchLightOn"/>
  </topic>
  <yakindusm
      timer="true"
      observer="true"
      name="SwitchSM">
    <outEvents
        interface="Publish"
        name="onTurnOn"
        topic="//@topic.0"
        message="//@topic.0/@messages.0"/>
    <outEvents
        interface="Publish"
        name="onTurnOff"
        topic="//@topic.0"
        message="//@topic.0/@messages.1"/>
    <inEvents
        interface="Controls"
        name="switchTurnOn"/>
  </yakindusm>
  <yakindusm
      name="Light">
    <inEvents
        interface="Controls"
        name="turnOn"
        topic="//@topic.0"
        message="//@topic.0/@messages.0"/>
    <inEvents
        interface="Controls"
        name="turnOff"
        topic="//@topic.0"
        message="//@topic.0/@messages.1"/>
  </yakindusm>
  <yakindusm
      observer="true"
      name="LightSensor">
    <outEvents
        interface="Publisher"
        name="dark"
        topic="//@topic.1"
        message="//@topic.1/@messages.0"/>
    <outEvents
        interface="Publisher"
        name="bright"
        topic="//@topic.1"
        message="//@topic.1/@messages.1"/>
    <inEvents
        interface="Controls"
        name="dark"/>
    <inEvents
        interface="Controls"
        name="bright"/>
  </yakindusm>
  <yakindusm
      timer="true"
      observer="true"
      name="MovementDetector">
    <outEvents
        interface="Publisher"
        name="detect"
        topic="//@topic.2"
        message="//@topic.2/@messages.0"/>
    <outEvents
        interface="Publisher"
        name="stop"
        topic="//@topic.2"
        message="//@topic.2/@messages.1"/>
    <inEvents
        interface="Controls"
        name="detect"/>
  </yakindusm>
  <yakindusm
      timer="true"
      observer="true"
      name="ControlPanel">
    <outEvents
        interface="Publisher"
        name="switchSprinklerOff"
        topic="//@topic.3"
        message="//@topic.3/@messages.0"/>
    <outEvents
        interface="Publisher"
        name="switchSprinklerOn"
        topic="//@topic.3"
        message="//@topic.3/@messages.1"/>
    <outEvents
        interface="Publisher"
        name="switchLightOff"
        topic="//@topic.3"
        message="//@topic.3/@messages.2"/>
    <outEvents
        interface="Publisher"
        name="switchLightOn"
        topic="//@topic.3"
        message="//@topic.3/@messages.3"/>
    <inEvents
        interface="Controls"
        name="switchSprinkler"/>
    <inEvents
        interface="Controls"
        name="switchLight"/>
  </yakindusm>
</allocation:CPS>
